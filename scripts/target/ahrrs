#!/bin/bash

### BEGIN INIT INFO
# Provides:          ahrrs
# Required-Start:    $network $syslog
# Required-Stop:     $network $syslog
# Default-Start:     2
# Default-Stop:      0 1 6
# Short-Description: position updates distributor for olsr networks
### END INIT INFO

NAME="ahrrs"
DAEMON=/usr/local/lib/pudUplinkServer/relayserver
PID_FILE=/var/run/$NAME.pid
test -x $DAEMON || exit 0

case "$1" in
  start)
    echo "Starting $NAME ..."
    start-stop-daemon -bS --exec $DAEMON
    rm /var/run/$NAME.stopped 2> /dev/null
    echo "Daemon $NAME started, wait for daemonize"
    sleep 3
    echo `pidof java` > $PID_FILE
  ;;
  stop)
    touch /var/run/$NAME.stopped
    echo  "Stopping $NAME ..."
    start-stop-daemon -mK --pidfile $PID_FILE
    sleep 1
    rm /var/run/$NAME.watchdog 2>/dev/null
    rm -f $PID_FILE 2>/dev/null
  ;;
  restart|force-reload)
    $0 stop
    $0 start
  ;;
  *)
    N=/etc/init.d/$NAME
    echo "Usage: $N {start|stop|restart}" >&2
    exit 1
  ;;
esac
exit 0
